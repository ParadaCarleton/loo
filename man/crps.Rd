% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crps.R
\name{crps}
\alias{crps}
\alias{scrps}
\alias{loo_crps}
\alias{loo_scrps}
\alias{crps.matrix}
\alias{crps.numeric}
\alias{loo_crps.matrix}
\alias{scrps.matrix}
\alias{scrps.numeric}
\alias{loo_scrps.matrix}
\title{Continuously ranked probability score}
\usage{
crps(x1, ...)

scrps(x1, ...)

loo_crps(x1, ...)

loo_scrps(x1, ...)

\method{crps}{matrix}(x1, x2, y, permutations = 1)

\method{crps}{numeric}(x1, x2, y, permutations = 1)

\method{loo_crps}{matrix}(x1, x2, y, ll, permutations = 1, r_eff = NULL, ...)

\method{scrps}{matrix}(x1, x2, y, permutations = 1)

\method{scrps}{numeric}(x1, x2, y, permutations = 1)

\method{loo_scrps}{matrix}(x1, x2, y, ll, permutations = 1, r_eff = NULL, ...)
}
\arguments{
\item{x1}{A S by N matrix, or a vector of length S when only single
observation is provided.}

\item{...}{Passed on to \code{E_loo()} in \verb{loo_*}-functions.}

\item{x2}{Independent draws from the same distribution as draws in \code{x1}.
Should be of the identical dimension.}

\item{y}{A vector of observations or a single value.}

\item{permutations}{An integer, with default value of 1,  specifying how many
times the expected value of  |X - X'| is computed. The row order of \code{x2}
is shuffled to as elements \code{x1} and \code{x2} are typically drawn given the
same value of parameters. This happens e.g. when one calls
\code{posterior_predict()} twice for a fitted \code{rstanarm} model. Generating
more permutations is expected to decrease the variance of the computed
expected value.}

\item{ll}{A log-likelihood.default or array (for \code{loo_}-functions)}

\item{r_eff}{A vector of relative effective sample size estimates containing
one element per observation (for \code{loo_}-functions).}
}
\value{
A list containing two elements: \code{estimates} and \code{pointwise}.
The former reports estimator and standard error and latter the pointwise
values.
}
\description{
The \code{crps()} and \code{scrps()} and their \code{loo} counterparts can be used to
compute the continuously ranked probability score (CRPS) and scaled CRPS
(SCRPS) (see Bolin and Wallin, 2022). CRPS is a proper scoring rule, and
strictly proper when the first moment of the predictive distribution is
finite. Both can be expressed in terms of samples form the predictive
distribution. See e.g. Gneiting and Raftery (2007) for a comprehensive
discussion on CRPS.
}
\details{
To compute (S)CRPS, user needs to provide two sets of draws from the
predictive distribution. I.e. one needs to call, for instance,
\code{posterior_predict()} two times and pass the returned values on to the CRPS
functions. This is due to the fact that formulas used to compute CRPS involve
an expectation of the absolute difference of \code{X1} and \code{X2}, both having the
same distribution. See Gneiting and Raftery (2007) for details.
}
\examples{
\dontrun{
# An example using rstanarm
library(rstanarm)
data("kidiq")
fit <- stan_glm(kid_score ~ mom_hs + mom_iq, data = kidiq)
ypred1 <- posterior_predict(fit)
ypred2 <- posterior_predict(fit)
y <- get_y(fit)
crps(ypred1, ypred2, y)
loo_crps(ypred1, ypred2, y, ll = log_lik(fit))
}

}
\references{
Bolin, D., & Wallin, J. (2022). Local scale invariance and robustness of
proper scoring rules. arXiv.
\url{https://doi.org/10.48550/arXiv.1912.05642}

Gneiting, T., & Raftery, A. E. (2007). Strictly Proper Scoring Rules,
Prediction, and Estimation. Journal of the American Statistical Association,
102(477), 359â€“378.
}
